<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Web IDE (MVP)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 200px;
    }
    select, button {
      margin-top: 10px;
      padding: 6px 10px;
    }
    pre {
      background: #f4f4f4;
      padding: 10px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h2>ğŸ–¥ Web IDE MVP</h2>

  <label for="env">ì–¸ì–´ ì„ íƒ:</label>
  <select id="env">
    <option value="docker-file">Python</option>
    <option value="js-image">Node.js</option>
  </select>

  <br />
  <button onclick="createContainer()">ì»¨í…Œì´ë„ˆ ìƒì„±</button>

  <script>
    async function createContainer() {
      const selectedImage = document.getElementById('env').value;

      try {
        const response = await fetch('/create', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ image: selectedImage }),
        });

<<<<<<< HEAD
        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.detail || 'Unknown error');
        }

        const data = await response.json();
        console.log('Container started:', data);
=======
            if (!res.ok) {
              const error = await res.json();
              throw new Error(error.detail || "Unknown error");
            }

            const data = await res.json();
            console.log("Container started:", data);
>>>>>>> 1c0e9d8963e0e0e0e05d87f0b2fd24e9c1e47b00

        // ì»¨í…Œì´ë„ˆ ì •ë³´ë¥¼ URL íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•˜ë©° index.htmlë¡œ ì´ë™
        const params = new URLSearchParams({
          container_name: data.name,
          novnc_port: data.novnc_port,
          image: data.image,
        });

        window.location.href = `/static/index.html?${params.toString()}`;
      } catch (e) {
        console.error('ì»¨í…Œì´ë„ˆ ìƒì„± ì‹¤íŒ¨:', e);
        alert('ì»¨í…Œì´ë„ˆ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n' + e.message);
      }
    }
  </script>
</body>
</html>
